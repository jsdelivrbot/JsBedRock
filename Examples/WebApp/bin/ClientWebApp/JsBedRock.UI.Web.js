!function(){new JsBedRock.Assemblies.AssemblyDef({Name:"JsBedRock.UI.Web",Dependencies:[new JsBedRock.Assemblies.AssemblyDependency({Name:"JsBedRock.UI"})],NodeDependencies:[]})}(),JsBedRock.UI=JsBedRock.UI||{},JsBedRock.UI.Web=JsBedRock.UI.Web||{},function(e){e.OnLoad(function(){JsBedRock.UI.Web.HtmlComponent=JsBedRock.Utils.ObjectOriented.CreateClass({Inherit:JsBedRock.UI.Component,Constructor:function(e,t,n){JsBedRock.Utils.ObjectOriented.CallBaseConstructor(this,JsBedRock.UI.Component,e,t,n)},Members:{Name:"",Init:function(){var e=this;this.Base(),watch(this._Model,function(t,n,o,s){e.Refresh()})},Render:function(){var e=this;return this.__ListenerRefreshQueue.Add(function(){e._InitListeners()}),new Handlebars.SafeString(this.Base())},Refresh:function(){var e=this.Base();return $("#"+this.GetDivID()).replaceWith(e.toString()),this.__ListenerRefreshQueue.ForEach(function(e){e()}),this.__ListenerRefreshQueue.Clear(),this._Renderer.ClearUnusedCachedComponents(),e},GetDivID:function(){return"JsBedRockComponent_"+this.ObjectGuid.ToString()},_InitListeners:function(){},__ListenerRefreshQueue:new JsBedRock.Collections.List}})})}(JsBedRock.CurrentAssembly),JsBedRock.UI=JsBedRock.UI||{},JsBedRock.UI.Web=JsBedRock.UI.Web||{},function(e){e.OnLoad(function(){JsBedRock.UI.Web.HtmlComponentRenderer=JsBedRock.Utils.ObjectOriented.CreateClass({Constructor:function(){this._ComponentCache=new JsBedRock.UI.ComponentCache,this._ComponentInstanceCache=new JsBedRock.Collections.Dictionary,this._CompiledTemplateCache=new JsBedRock.Collections.Dictionary,JsBedRock.Utils.ObjectOriented.CallBaseConstructor(this,JsBedRock.Types.Object)},Members:{Init:function(e){var t=this;this._ComponentCache.PopulateCache(),this._ComponentFactory=e;for(var n in this._ComponentCache.GetComponents())Handlebars.registerHelper(n,this._GenerateHelperFunction(t,n))},Render:function(e,t,n){return this._CompiledTemplateCache.Contains(e)||this._CompiledTemplateCache.Add(e,Handlebars.compile(e)),this._WrapRenderedTemplate(this._CompiledTemplateCache.Get(e)(t),n)},ClearUnusedCachedComponents:function(){var e=this;this._ComponentInstanceCache.ForEach(function(t,n){0===$("#"+n.GetDivID()).length&&e._ComponentInstanceCache.Remove(t)})},_WrapRenderedTemplate:function(e,t){return"<div id='"+t.GetDivID()+"'>"+e+"</div>"},_GenerateHelperFunction:function(e,t){return function(n){return e._GetOrCreateComponentInstance(n.ObjectGuid.ToString(),t,n).Render()}},_GetOrCreateComponentInstance:function(e,t,n){return this._ComponentInstanceCache.Contains(t+"_"+e)||this._ComponentInstanceCache.Add(t+"_"+e,this._ComponentFactory.GetComponent(this._ComponentCache.GetComponentFromKey(t),n)),this._ComponentInstanceCache.Get(t+"_"+e)},_ComponentCache:null,_ComponentFactory:null,_ComponentInstanceCache:null,_CompiledTemplateCache:null},Implements:[JsBedRock.UI.IComponentRenderer]})})}(JsBedRock.CurrentAssembly),JsBedRock.UI=JsBedRock.UI||{},JsBedRock.UI.Web=JsBedRock.UI.Web||{},function(e){e.OnLoad(function(){JsBedRock.UI.Web.WebAppRouteDef=JsBedRock.Utils.ObjectOriented.CreateClass({Constructor:function(e,t){this.Component=e,this.Context=t,JsBedRock.Utils.ObjectOriented.CallBaseConstructor(this,JsBedRock.Types.Object)},Members:{Component:null,Context:null}})})}(JsBedRock.CurrentAssembly),JsBedRock.UI=JsBedRock.UI||{},JsBedRock.UI.Web=JsBedRock.UI.Web||{},function(e){e.OnLoad(function(){JsBedRock.UI.Web.WebAppRouterResult=JsBedRock.Utils.ObjectOriented.CreateClass({Constructor:function(e,t){this.Component=e,this.Context=t,JsBedRock.Utils.ObjectOriented.CallBaseConstructor(this,JsBedRock.Types.Object)},Members:{Component:null,Context:null}})})}(JsBedRock.CurrentAssembly),JsBedRock.UI=JsBedRock.UI||{},JsBedRock.UI.Web=JsBedRock.UI.Web||{},function(e){e.OnLoad(function(){JsBedRock.UI.Web.WebAppRouter=JsBedRock.Utils.ObjectOriented.CreateClass({Constructor:function(){JsBedRock.Utils.ObjectOriented.CallBaseConstructor(this,JsBedRock.Types.Object)},Members:{LoadRoutes:function(e){this._Routes=e},ParseRouteResult:function(){var e=document.location.toString();if(-1!=e.indexOf("#")){var t=e.split("#")[1],n=t.split("/");if(this._Routes.Contains(n[0]))return new JsBedRock.UI.Web.WebAppRouterResult(this._Routes.Get(n[0]).Component,this._BuildContext(n[0],n))}return new JsBedRock.UI.Web.WebAppRouterResult(this._Routes.Get("Default").Component,this._BuildContext("Default",n))},_BuildContext:function(e,t){if(t&&t instanceof Array&&t.length>1){var n=this._Routes.Get(e);if(n){t.shift();var o={};for(var s in n.Context)t.length>=s&&(o[n.Context[s]]=t[s]);return o}}return{}},_Routes:null}})})}(JsBedRock.CurrentAssembly),JsBedRock.UI=JsBedRock.UI||{},JsBedRock.UI.Web=JsBedRock.UI.Web||{},function(e){e.OnLoad(function(){JsBedRock.UI.Web.WebAppStart=JsBedRock.Utils.ObjectOriented.CreateClass({Constructor:function(){JsBedRock.Utils.ObjectOriented.CallBaseConstructor(this,JsBedRock.Types.Object)},Members:{Main:function(){this._CompFactory=new JsBedRock.UI.ComponentFactory(new JsBedRock.UI.Web.HtmlComponentRenderer,new JsBedRock.UI.ServiceFactory),this._CompFactory.Init(),this._Router=new JsBedRock.UI.Web.WebAppRouter,this._Router.LoadRoutes(this.GetRoutes());var e=this;$(document).ready(function(){e._SetPage()})},GetRoutes:function(){var e=new JsBedRock.Collections.Dictionary;return e},_SetPage:function(){var e=this._Router.ParseRouteResult();document.getElementById("AppBody").innerHTML=this._CompFactory.GetComponent(e.Component,e.Context).Refresh()},_CompFactory:null,_Router:null}})})}(JsBedRock.CurrentAssembly),function(e){JsBedRock.Assemblies.GlobalAssemblyCache.RegisterAssembly(e)}(JsBedRock.CurrentAssembly);
//# sourceMappingURL=bin/0.16.02/JsBedRock.UI.Web.js.map